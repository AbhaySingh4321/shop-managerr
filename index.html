<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shop Stock Manager</title>
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Login Page -->
  <div id="loginContainer" class="container login-page">
    <div class="login-box">
      <h1>üõçÔ∏è Shop Stock Manager</h1>
      <p class="subtitle">Cloud-Based Inventory Management</p>
      <form id="loginForm">+++
        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" id="email" placeholder="admin@shop.com" required />
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" id="password" placeholder="admin123" required />
        </div>
        <button type="submit" class="btn btn-primary">Login</button>
        <p class="error-msg" id="loginError"></p>
      </form>
      <p class="info-text">Test: admin@shop.com / admin123</p>
    </div>
  </div>

  <!-- Dashboard -->
  <div id="dashboardContainer" class="container dashboard-page" style="display: none;">
    <nav class="navbar">
      <h1>üõçÔ∏è Shop Stock Manager</h1>
      <ul class="nav-menu">
        <li><button onclick="showSection('dashboard')" class="nav-btn active" id="nav-dashboard">Dashboard</button></li>
        <li><button onclick="showSection('inventory')" class="nav-btn" id="nav-inventory">Inventory</button></li>
        <li><button onclick="showSection('sale')" class="nav-btn" id="nav-sale">Record Sale</button></li>
        <li><button onclick="showSection('restock')" class="nav-btn" id="nav-restock">Add Stock</button></li>
        <li><button onclick="showSection('sales-history')" class="nav-btn" id="nav-history">Sales</button></li>
        <li><button onclick="showSection('restock-history')" class="nav-btn" id="nav-restock-history">Restocks</button></li>
        <li><button onclick="logout()" class="nav-btn logout">Logout</button></li>
      </ul>
    </nav>

    <!-- Dashboard Section -->
    <div id="dashboard-section" class="section active">
      <h2>Dashboard</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Total Products</h3>
          <p class="stat-value" id="totalProducts">0</p>
        </div>
        <div class="stat-card">
          <h3>Total Sales</h3>
          <p class="stat-value" id="totalSales">0</p>
        </div>
        <div class="stat-card">
          <h3>Total Restock</h3>
          <p class="stat-value" id="totalRestock">0</p>
        </div>
        <div class="stat-card alert">
          <h3>Low Stock</h3>
          <p class="stat-value" id="lowStockCount">0</p>
        </div>
      </div>
      <h3>Low Stock Products</h3>
      <table class="table">
        <thead>
          <tr>
            <th>Product</th>
            <th>Stock</th>
            <th>Unit</th>
          </tr>
        </thead>
        <tbody id="lowStockTable"></tbody>
      </table>
    </div>

    <!-- Inventory Section -->
    <div id="inventory-section" class="section" style="display: none;">
      <h2>Manage Inventory</h2>
      <div class="form-section">
        <h3>Add Product</h3>
        <form id="addProductForm">
          <div class="form-row">
            <div class="form-group">
              <label for="productName">Product Name</label>
              <input type="text" id="productName" placeholder="e.g., Rice" required />
            </div>
            <div class="form-group">
              <label for="productStock">Stock</label>
              <input type="number" id="productStock" placeholder="0" min="0" required />
            </div>
            <div class="form-group">
              <label for="productUnit">Unit</label>
              <input type="text" id="productUnit" placeholder="e.g., kg" required />
            </div>
            <div class="form-group">
              <label for="productPrice">Price</label>
              <input type="number" id="productPrice" placeholder="0" min="0" step="0.01" />
            </div>
          </div>
          <button type="submit" class="btn btn-primary">Add Product</button>
          <p class="success-msg" id="addProductMsg"></p>
        </form>
      </div>
      <h3>Products</h3>
      <table class="table">
        <thead>
          <tr>
            <th>Product Name</th>
            <th>Stock</th>
            <th>Unit</th>
            <th>Price</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="productsTable"></tbody>
      </table>
    </div>

    <!-- Record Sale Section -->
    <!-- Record Sale Section -->
<div id="sale-section" class="section" style="display: none;">
  <h2>Record Sale</h2>
  <div class="form-section">
    <h3>Add Items to Sale</h3>
    <form id="singleItemForm">
      <div class="form-row">
        <div class="form-group">
          <label for="saleProductSearch">Search Product</label>
          <input type="text" id="saleProductSearch" placeholder="Type product name..." />
          <select id="saleProduct" required>
            <option value="">Select product</option>
          </select>
        </div>
        <div class="form-group">
          <label for="saleQuantity">Quantity</label>
          <input type="number" id="saleQuantity" placeholder="0" min="1" required />
        </div>
      </div>
      <button type="button" class="btn btn-primary" onclick="addItemToSale()">Add Item</button>
    </form>
  </div>

  <!-- Items in current sale -->
  <div class="form-section">
    <h3>Items in This Sale</h3>
    <table class="table">
      <thead>
        <tr>
          <th>Product</th>
          <th>Qty</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="saleItemsTable"></tbody>
    </table>
  </div>

  <!-- Customer and submit -->
  <div class="form-section">
    <form id="recordSaleForm">
      <div class="form-group">
        <label for="customerName">Customer Name</label>
        <input type="text" id="customerName" placeholder="Enter customer name" required />
      </div>
      <button type="submit" class="btn btn-primary">Complete Sale</button>
      <p class="error-msg" id="saleError"></p>
      <p class="success-msg" id="saleSuccess"></p>
    </form>
  </div>
</div>



    <!-- Add Stock Section -->
    <div id="restock-section" class="section" style="display: none;">
      <h2>Add/Restock Stock</h2>
      <div class="form-section">
        <form id="addStockForm">
          <div class="form-row">
            <div class="form-group">
              <label for="supplierName">Supplier Name</label>
              <input type="text" id="supplierName" placeholder="Enter supplier name" required />
            </div>
            <div class="form-group">
              <label for="restockProduct">Product</label>
              <select id="restockProduct" required>
                <option value="">Select product</option>
              </select>
            </div>
            <div class="form-group">
              <label for="restockQuantity">Quantity</label>
              <input type="number" id="restockQuantity" placeholder="0" min="1" required />
            </div>
          </div>
          <div class="form-group">
            <label for="restockNotes">Notes</label>
            <textarea id="restockNotes" placeholder="Add notes..."></textarea>
          </div>
          <button type="submit" class="btn btn-primary">Add Stock</button>
          <p class="success-msg" id="restockSuccess"></p>
        </form>
      </div>
    </div>

    <!-- Sales History Section -->
    <!-- Sales History Section -->
<div id="sales-history-section" class="section" style="display: none;">
  <h2>Sales History</h2>
  
  <div class="form-section">
    <h3>Search & Filter</h3>
    <div class="form-row">
      <div class="form-group">
        <label for="searchCustomer">Search by Customer/Product</label>
        <input type="text" id="searchCustomer" placeholder="Enter customer or product name" />
      </div>
      <div class="form-group">
        <label for="searchFromDate">From Date</label>
        <input type="date" id="searchFromDate" />
      </div>
      <div class="form-group">
        <label for="searchToDate">To Date</label>
        <input type="date" id="searchToDate" />
      </div>
    </div>
    <button class="btn btn-primary" onclick="filterSalesHistory()">Search</button>
    <button class="btn btn-secondary" onclick="resetSalesFilter()">Reset</button>
  </div>

  <div class="table-responsive">
    <table class="table">
      <thead>
        <tr>
          <th>Customer</th>
          <th>Product</th>
          <th>Qty</th>
          <th>Date & Time</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="salesHistoryTable"></tbody>
    </table>
  </div>
</div>


    <!-- Restock History Section -->
    <!-- Restock History Section -->
<div id="restock-history-section" class="section" style="display: none;">
  <h2>Restock History</h2>
  
  <div class="form-section">
    <h3>Search & Filter</h3>
    <div class="form-row">
      <div class="form-group">
        <label for="searchSupplier">Search by Supplier/Product</label>
        <input type="text" id="searchSupplier" placeholder="Enter supplier or product name" />
      </div>
      <div class="form-group">
        <label for="restockFromDate">From Date</label>
        <input type="date" id="restockFromDate" />
      </div>
      <div class="form-group">
        <label for="restockToDate">To Date</label>
        <input type="date" id="restockToDate" />
      </div>
    </div>
    <button class="btn btn-primary" onclick="filterRestockHistory()">Search</button>
    <button class="btn btn-secondary" onclick="resetRestockFilter()">Reset</button>
  </div>

  <div class="table-responsive">
    <table class="table">
      <thead>
        <tr>
          <th>Supplier</th>
          <th>Product</th>
          <th>Qty</th>
          <th>Date & Time</th>
          <th>Notes</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="restockHistoryTable"></tbody>
    </table>
  </div>
</div>


  <!-- Confirmation Modal -->
  <div id="confirmModal" class="modal" style="display: none;">
    <div class="modal-content">
      <h2 id="confirmTitle">Confirm</h2>
      <p id="confirmMessage"></p>
      <div class="modal-buttons">
        <button onclick="confirmAction()" class="btn btn-danger">Delete</button>
        <button onclick="cancelAction()" class="btn btn-secondary">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Supabase SDK -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="supabase-config.js"></script>
  <script src="script.js"></script>

</body>
</html>

